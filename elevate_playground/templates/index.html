<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Legal Advisor App</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    .notification-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background-color: #dc3545;
      border-radius: 50%;
      height: 18px;
      width: 18px;
      font-size: 10px;
      color: white;
      text-align: center;
      line-height: 18px; 
    }
    .sparkle {
      height: 6px; 
      width: 6px; 
      background-color: #20c0aa; 
      border-radius: 50%; 
      display: block; 
      position: absolute; 
    }
    .sparkle:nth-child(1) {
      top: 8px; 
      left: 8px;
    }
    .sparkle:nth-child(2) {
      top: 16px; 
      right: 8px;
    }
    .sparkle:nth-child(3) {
      bottom: 8px; 
      left: 20px;
    }
    .vertical-toolbar {
      background-color: white;
      width: 50px;
      position: fixed;
      top: 0;
      left: 0;
      bottom: 0;
    }
    .vertical-toolbar .nav-link {
      color: #818a91;
      padding: 1rem;
    }
    .vertical-toolbar .nav-link:hover {
      background-color: rgba(0,0,0,.05); 
    }

    /* Styling for smaller screens - Mobile First */
    @media (max-width: 768px) { 
      .btn-group-vertical {
        display: flex;
        flex-direction: column;
      }
      .btn-group-vertical > .btn {
        margin-bottom: 10px;
      }
      .fixed-bottom {
        position: static!important;
        width: 100%;
      }
    }
  </style>
  <script>
    (function(apiKey){
      (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
      v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
        o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
        y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
        z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');
    })('1ecd6906-2e67-4214-485c-176a4edaea45');
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

</head>
<body style="background-color: #f2f2f2;">
  <nav class="navbar navbar-light bg-white px-3" style="border-bottom: 1px solid #e6e6e6;">
    <span class="navbar-brand" style="font-size: 20px;">
      <span style="height: 24px; width: 24px; background-color: #20c0aa; border-radius: 50%; display: inline-block;"></span>
      <!-- <span style="color: #20c0aa; font-weight: 600; margin-left: 8px;">elevate</span> -->
      <a href=".">
        <img src="images/elevate_logo.png" alt="Elevate" style="height: 48px;">
      </a>

    </span>
    <!-- <form class="form-inline my-2 my-lg-0">
      <div class="input-group rounded" style="background-color: white;">
        <div class="input-group-prepend">
          <span class="input-group-text border-0" style="background-color: white;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#818a91" class="bi bi-search" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </span>
        </div>
        <input class="form-control border-0" type="search" placeholder="Search" aria-label="Search" style="background-color: white;">
      </div>
    </form>
    <div>
      <span style="position: relative;">
        <span class="notification-badge">99+</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="#818a91" class="bi bi-bell" viewBox="0 0 16 16">
          <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zM8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .828.333 1.554.898 2.042l.803.171c.564.123 1.178.133 1.772.06L8 13.10c.64-.071 1.21-.244 1.722-.516.526-.287.936-.692 1.176-1.155C10 6.12 10 5.375 10 4.717a2.5 2.5 0 1 0-5 0c0 1.712 1.03 3.291 2.616 4.243l.803.171c.564.123 1.178.133 1.772.061A4.002 4.002 0 0 0 12 6a4.002 4.002 0 0 0-3.203-3.142l-.797.161z"/>
          <path d="M13.956 5.444c.824-.885 1.396-1.977 1.396-3.253 0-1.276-.57-2.368-1.395-3.252A3.989 3.989 0 0 0 11 2H6A3.989 3.989 0 0 0 3 8c0 1.286.574 2.377 1.396 3.253C5.514 13.918 7.284 16 9 16c1.716 0 3.486-2.082 4.944-5.556z"/>
        </svg>
      </span>
      <span style="height: 24px; width: 24px; background-color: #3498db; border-radius: 50%; display: inline-block; margin-left: 16px; color: white; font-size: 12px; text-align: center; line-height: 24px;">LM</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#818a91" class="bi bi-chevron-right" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
      </svg>
    </div> -->
  </nav>

<!-- Main chatbox -->
  <div id="chatHistory" class="container-fluid" style="padding-left: 60px; padding-bottom: 100px;">
    <div class="row" style="margin-top: 24px;" id="welcomeSign">
      <div class="col-12 d-inline-block" style="text-align: center;">
        <img src="images/elevate_ai_logo.png" alt="Elevate AI" style="height: 110px; width: 110px">
        <h3 style="font-weight: 600;">Hi! I'm your <span style="color: #20c0aa;">Legal Advisor</span>.</h3>
        <h3 style="font-weight: 600;">How can I help you today?</h3>
        <p style="color: #818a91; font-size: 14px; margin-top: 12px;">Ask for information on deal points, matters, clients, and people in your firm.</p>
      </div>
    </div>
    <div class="row d-flex justify-content-center align-items-center" id="suggestedPrompts">
      <div class="col-12 text-center">
        <button id="prompt1" type="button" class="btn btn-light rounded-pill mr-2 mb-2" style="background-color: #e7f5ff;">Explain Legal Concept <span style="color: #868e96;">+</span><span class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span class="sr-only">Toggle Dropdown</span>
        </span></button>
        <button id="prompt2" type="button" class="btn btn-light rounded-pill mr-2 mb-2" style="background-color: #e7f5ff;">Review Document <span style="color: #868e96;">+</span><span class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span class="sr-only">Toggle Dropdown</span>
        </span></button>
        <button id="prompt3" type="button" class="btn btn-light rounded-pill mr-2 mb-2" style="background-color: #e7f5ff;">Find Case Law <span style="color: #868e96;">+</span><span class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span class="sr-only">Toggle Dropdown</span>
        </span></button>
      </div>
    </div>
  </div>
<!-- Main chatbox -->

<!-- Bottom input bar -->
  <form id="chatForm">
    <div class="fixed-bottom px-3 py-3" style="background-color: #f2f2f2;">
      <div id="fileDisplay"class="d-flex">
        <div id="fileIcon" class="d-none bg-white">üìÅ </div>
        <div id="fileName" class="d-none bg-white"></div>
      </div>

      <div class="input-group rounded" style="background-color: white;">
        <label for="fileInput" class="btn btn-light">
          üìé
        </label>
        <input type="file" id="fileInput" name="file" style="display: none;" accept=".pdf" onchange="uploadFile()">
        <input name="prompt" id="chatInput" type="text" class="form-control border-0" placeholder="" style="background-color: white;" autocomplete="off" value="">
        <div class="input-group-append">
          <button id="submitButton" class="btn btn-light rounded-0" type="submit" style="background-color: #3498db;" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" class="bi-send" viewBox="0 0 16 16">
              <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124L5.468 10.69 1.122 8.663a.75.75 0 0 1 .033-1.388L15.854.146zm-4.511 9.327L6.517 8.152 2.462 6.561l7.607-4.78-1.024 6.556z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </form>
<!-- Bottom input bar -->

<!-- Left vertical toolbar -->
  <div class="vertical-toolbar">
    <ul class="nav flex-column">
      <li class="nav-item">
        <a class="nav-link" href=".">
          <i class="bi bi-house-fill"></i>
        </a>
      </li>
    </ul>
  </div>
 <!-- Left vertical toolbar  -->

<script type="module" src="/main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it@12.0.6/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
<script>
  function uploadFile() {
    const fileInput = document.getElementById('fileInput');
    const file = fileInput.files[0]; // Get the selected file
    const submitButton = document.getElementById('submitButton');

    if (!file) {
      alert('Please select a file to upload.');
      return;
    }
    const chatButtons = document.getElementById('suggestedPrompts');

    if (chatButtons) {
        chatButtons.remove();
    }
    // File display
    const fileName = document.getElementById('fileName');
    const fileIcon = document.getElementById('fileIcon');
    fileName.textContent = "Uploading...";
    fileName.className = "bg-white";
    fileIcon.className = "bg-white";
    submitButton.disabled = true;

    const formData = new FormData();
    formData.append('file', file);

    fetch('/upload', { // Adjust the URL to your server's upload endpoint
      method: 'POST',
      body: formData,
    })
    .then(response => response.json())
    .then(data => {
      console.log('File uploaded successfully:', data);
      // Handle success
      // cardElement.textContent = 'üìÑ ' + file.name; // Replace the text
      fileName.textContent = file.name;
      submitButton.disabled = false;
    })
    .catch(error => {
      console.error('Error uploading file:', error);
      // Handle error
      // cardElement.textContent = 'File upload failed.';
      fileName.textContent = 'File upload failed.';
      submitButton.disabled = false;
    });
  }
  </script>
  <script>
    pendo.initialize({
    visitor: {
      id: '{{ user.id }}',
    },
    account: {
      id: '{{ user.id }}',
    }
  });
  </script>
</body>

</html>